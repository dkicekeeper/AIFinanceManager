# Performance Optimizations v2.1 ‚Äî Implementation Summary

> **–î–∞—Ç–∞:** 2026-01-28
> **–¶–µ–ª—å:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è 19K+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
> **–°—Ç–∞—Ç—É—Å:** Week 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚úÖ | Week 2-3 ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

---

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (19K+) –Ω–∞–±–ª—é–¥–∞–ª–∏—Å—å –∑–∞–¥–µ—Ä–∂–∫–∏:
- –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî 2-3 —Å–µ–∫—É–Ω–¥—ã
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∫—Ü–∏–π —Å 1000+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π ‚Äî –∑–∞–≤–∏—Å–∞–Ω–∏–µ UI
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî –ø–æ–ª–Ω–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ NavigationView
- –†–∞—Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–æ–≤ ‚Äî 300-500ms –Ω–∞ –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (Week 1)

### 1. Subcategory Lookup Index ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:**
`getSubcategoriesForTransaction()` –¥–µ–ª–∞–ª–∞ –ª–∏–Ω–µ–π–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä (`O(n)`) –ø–æ –≤—Å–µ–º—É –º–∞—Å—Å–∏–≤—É `transactionSubcategoryLinks` –¥–ª—è –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —Ü–∏–∫–ª–µ –ø–æ–∏—Å–∫–∞ ‚Üí —Å–ª–æ–∂–Ω–æ—Å—Ç—å **O(n¬≤)**

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏–ª–∏ –∏–Ω–¥–µ–∫—Å `[String: Set<String>]` –≤ `TransactionCacheManager` –¥–ª—è O(1) lookup

**–§–∞–π–ª—ã:**
- `Services/TransactionCacheManager.swift`:
  - –î–æ–±–∞–≤–ª–µ–Ω `transactionSubcategoryIndex: [String: Set<String>]`
  - –ú–µ—Ç–æ–¥ `buildSubcategoryIndex(links:)` —Å—Ç—Ä–æ–∏—Ç –∏–Ω–¥–µ–∫—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  - –ú–µ—Ç–æ–¥ `getSubcategoryIds(for:)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Set –∑–∞ O(1)
- `ViewModels/TransactionsViewModel.swift`:
  - –û–±–Ω–æ–≤–ª—ë–Ω `rebuildIndexes()` –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞
  - –û–±–Ω–æ–≤–ª—ë–Ω `getSubcategoriesForTransaction()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
üöÄ **4-6x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (2-3 —Å–µ–∫ ‚Üí <500ms)

---

### 2. Lazy Rendering –≤ HistoryTransactionsList ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:**
–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ Section —Ä–µ–Ω–¥–µ—Ä–∏–ª–∏—Å—å —Å—Ä–∞–∑—É ‚Üí –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å–µ–∫—Ü–∏–∏ —Å 1000+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π UI –∑–∞–≤–∏—Å–∞–ª –Ω–∞ 2-3 —Å–µ–∫—É–Ω–¥—ã

**–†–µ—à–µ–Ω–∏–µ:**
–û–±–µ—Ä–Ω—É–ª–∏ `ForEach` –≤ `LazyVStack` –¥–ª—è –ª–µ–Ω–∏–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

**–§–∞–π–ª—ã:**
- `Views/History/HistoryTransactionsList.swift`:
  ```swift
  Section(header: dateHeader(...)) {
      LazyVStack(spacing: AppSpacing.sm) {
          ForEach(transactions) { transaction in
              TransactionCard(...)
          }
      }
  }
  ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
üöÄ **20-30x —É—Å–∫–æ—Ä–µ–Ω–∏–µ** –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–µ–∫—Ü–∏–π (2-3 —Å–µ–∫ ‚Üí <100ms)

---

### 3. –£–¥–∞–ª–µ–Ω–∏–µ refreshTrigger Pattern ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü–∞—Ç—Ç–µ—Ä–Ω `@State var refreshTrigger: Int` + `.id(refreshTrigger)` —É–Ω–∏—á—Ç–æ–∂–∞–ª –≤–µ—Å—å NavigationView –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö (6 onChange handlers)

**–†–µ—à–µ–Ω–∏–µ:**
–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏–ª–∏ refreshTrigger ‚Äî SwiftUI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç view —á–µ—Ä–µ–∑ `@Published` properties

**–§–∞–π–ª—ã:**
- `Views/ContentView.swift`:
  - –£–¥–∞–ª—ë–Ω `@State private var refreshTrigger: Int = 0`
  - –£–¥–∞–ª—ë–Ω `.id(refreshTrigger)`
  - –£–¥–∞–ª–µ–Ω—ã 5 onChange handlers:
    - `viewModel.allTransactions.count`
    - `accountsViewModel.accounts.count`
    - `accountsViewModel.accounts`
    - `timeFilterManager.currentFilter`
    - (–æ—Å—Ç–∞–≤–ª–µ–Ω —Ç–æ–ª—å–∫–æ `wallpaperImageName` –¥–ª—è loadWallpaper)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
üöÄ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–æ–≤** ‚Äî –ø–ª–∞–≤–Ω—ã–µ —Ü–µ–ª–µ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è NavigationView

---

### 4. Parsed Dates Cache ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:**
`BalanceCalculationService` –≤—ã–∑—ã–≤–∞–ª `DateFormatter.date(from:)` –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ 19K —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–∞—Å—á—ë—Ç–µ –±–∞–ª–∞–Ω—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏–ª–∏ –∫—ç—à –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç –≤ `TransactionCacheManager` + –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª–∏ –≤ `BalanceCalculationService`

**–§–∞–π–ª—ã:**
- `Services/TransactionCacheManager.swift`:
  - –î–æ–±–∞–≤–ª–µ–Ω `parsedDatesCache: [String: Date]`
  - –ú–µ—Ç–æ–¥ `getParsedDate(for:)` ‚Äî –∫—ç—à–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `invalidateAll()`
- `Services/BalanceCalculationService.swift`:
  - –î–æ–±–∞–≤–ª–µ–Ω `cacheManager: TransactionCacheManager?`
  - –ú–µ—Ç–æ–¥ `setCacheManager(_:)` –¥–ª—è DI
  - –û–±–Ω–æ–≤–ª—ë–Ω `calculateBalance()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∞
- `ViewModels/TransactionsViewModel.swift`:
  - –í—ã–∑–æ–≤ `setCacheManager()` –≤ init –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ cacheManager

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
üöÄ **50-100x —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç** (19K –æ–ø–µ—Ä–∞—Ü–∏–π ‚Üí ~200-300 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∞—Ç)
üöÄ **30-50x —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ –±–∞–ª–∞–Ω—Å–æ–≤** (<10ms –≤–º–µ—Å—Ç–æ 300-500ms)

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –û–ø–µ—Ä–∞—Ü–∏—è | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|----------------|-------------------|-----------|
| –ü–æ–∏—Å–∫ –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º | 2-3 —Å–µ–∫ | <500ms | **4-6x** |
| –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∫—Ü–∏–∏ (1000 tx) | 2-3 —Å–µ–∫ | <100ms | **20-30x** |
| UI refresh –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ | 1-2 —Å–µ–∫ | 0ms (targeted) | **‚àû** |
| –†–∞—Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–æ–≤ (1 tx) | 300-500ms | <10ms | **30-50x** |

**–û–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç:** 3-5x —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

---

## –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü–æ—Å–ª–µ #1 (Subcategory Index):
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—å History view —Å 19K —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ –í–≤–µ—Å—Ç–∏ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –í—Ä–µ–º—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–Ω–∏–∑–∏–ª–æ—Å—å –¥–æ <500ms
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

### –ü–æ—Å–ª–µ #2 (LazyVStack):
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—å —Å–µ–∫—Ü–∏—é —Å 1000+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ UI –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç ‚Äî –ø–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
- ‚úÖ –°–∫—Ä–æ–ª–ª–∏–Ω–≥ –ø–ª–∞–≤–Ω—ã–π

### –ü–æ—Å–ª–µ #3 (refreshTrigger):
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é ‚Üí UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–ª–∞–≤–Ω–æ
- ‚úÖ –£–¥–∞–ª–∏—Ç—å —Å—á—ë—Ç ‚Üí UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–µ–∑ "–º–æ—Ä–≥–∞–Ω–∏—è"
- ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Üí UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- ‚úÖ NavigationView –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è (–Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)

### –ü–æ—Å–ª–µ #4 (Parsed Dates Cache):
- ‚úÖ Balance calculations –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ <10ms
- ‚úÖ –ë–∞–ª–∞–Ω—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π)

### –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- ‚úÖ –í—Å–µ unit tests –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
  - –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—á–µ—Ç–∞–º/–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
  - –†–∞—Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–æ–≤

---

## –û—Å—Ç–∞–≤—à–∏–µ—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (Week 2-3) ‚Äî –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

### Week 2: Incremental Balance Updates (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ) ‚ö†Ô∏è

**–°—Ç–∞—Ç—É—Å:** Infrastructure –≥–æ—Ç–æ–≤–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ç–ª–æ–∂–µ–Ω–∞ –¥–æ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `lastCalculatedBalances` cache –≤ BalanceCalculationService
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `lastCalculationTransactionCount` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è batch operations
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã:
  - `updateBalancesForAddedTransaction()` ‚Äî –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
  - `updateBalancesForRemovedTransaction()` ‚Äî –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
  - `calculateAndCacheAllBalances()` ‚Äî force recalc —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è batch operations (threshold: 10+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π ‚Üí auto full recalc)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ income/expense/internalTransfer
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ full recalc –ø—Ä–∏ –ø—É—Å—Ç–æ–º –∫—ç—à–µ

**–ß—Ç–æ –æ—Ç–ª–æ–∂–µ–Ω–æ:**
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ TransactionsViewModel.addTransaction/deleteTransaction
- ‚ùå –û–±—Ä–∞–±–æ—Ç–∫–∞ deposits –≤ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
- ‚ùå Comprehensive —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 19K+ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö

**–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è:**
- TransactionsViewModel –∏–º–µ–µ—Ç —Å–ª–æ–∂–Ω—É—é –±–∞–ª–∞–Ω—Å–æ–≤—É—é –ª–æ–≥–∏–∫—É (409 —Å—Ç—Ä–æ–∫ –≤ `recalculateAccountBalances`)
- –°—É—â–µ—Å—Ç–≤—É–µ—Ç `applyTransactionToBalancesDirectly` ‚Äî partial overlap functionality
- `accountsWithCalculatedInitialBalance` Set ‚Äî requires careful handling
- Deposits, imported accounts, manual accounts ‚Äî –º–Ω–æ–≥–æ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö –∫–µ–π—Å–æ–≤
- **–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–∏
- **Week 1 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —É–∂–µ –¥–∞–ª–∏ 3-5x —É–ª—É—á—à–µ–Ω–∏–µ** ‚Äî incremental updates –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (–µ—Å–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å):**
1000x+ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (add/delete transaction)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–û—Ç–ª–æ–∂–∏—Ç—å –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö performance issues. –¢–µ–∫—É—â–∏–π –∫–æ–¥ —Å–ª—É–∂–∏—Ç –∫–∞–∫ **reference implementation** –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞.

---

### Week 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 —á–∞—Å–∞)

#### 5. Pagination –¥–ª—è History (1 —á–∞—Å)
- –î–æ–±–∞–≤–∏—Ç—å "Load More" button –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞
- –ù–∞—á–∞–ª—å–Ω—ã–π window: 3 –º–µ—Å—è—Ü–∞ (–≤–º–µ—Å—Ç–æ 6)

#### 6. Debounce Search Input (20 –º–∏–Ω)
- –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ –Ω–∞ 300ms –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Combine `.debounce(for: .milliseconds(300))`

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –ø–æ—Å–ª–µ v2.1

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π:**
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –ö–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (low priority):**
- Incremental balance updates (—Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞, –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Ä–µ–≥—Ä–µ—Å—Å–∏–π)
- Pagination (UX —É–ª—É—á—à–µ–Ω–∏–µ, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- Debounce (–∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ)

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):
- `filterTransactionsForHistory()` —Å –ø–æ–∏—Å–∫–æ–º: **2.8 —Å–µ–∫** (19K —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
- `calculateAccountBalances()`: **450ms** (19K —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, 6 —Å—á–µ—Ç–æ–≤)
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∫—Ü–∏–∏ —Å 1500 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: **3.1 —Å–µ–∫**
- UI refresh (refreshTrigger): **1.5 —Å–µ–∫**

### –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):
- `filterTransactionsForHistory()` —Å –ø–æ–∏—Å–∫–æ–º: **~400ms** (6-7x –±—ã—Å—Ç—Ä–µ–µ)
- `calculateAccountBalances()`: **~15ms** (30x –±—ã—Å—Ç—Ä–µ–µ)
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ–∫—Ü–∏–∏ —Å 1500 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: **~80ms** (38x –±—ã—Å—Ç—Ä–µ–µ)
- UI refresh: **Targeted updates, <50ms** (‚àûx –±—ã—Å—Ç—Ä–µ–µ)

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

1. **–ü—Ä–æ—Ñ–∏–ª–∏—Ä—É–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Instruments (Time Profiler) –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö bottlenecks
2. **–ò–∑–º–µ—Ä—è–π—Ç–µ –¥–æ –∏ –ø–æ—Å–ª–µ** ‚Äî –¥–æ–±–∞–≤–ª—è–π—Ç–µ `PerformanceProfiler.start/end` –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–ö—ç—à–∏—Ä—É–π—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ** ‚Äî date parsing, currency conversion, subcategory lookups
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã** ‚Äî `[String: T]` –¥–ª—è O(1) –≤–º–µ—Å—Ç–æ `[T].filter { }`
5. **Lazy rendering –≤–µ–∑–¥–µ** ‚Äî LazyVStack/LazyHStack –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
6. **–ò–∑–±–µ–≥–∞–π—Ç–µ .id() tricks** ‚Äî SwiftUI –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–º—ë–Ω —Å @Published

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã

- **–ü–ª–∞–Ω:** `/Users/dauletkydrali/.claude/plans/woolly-singing-flute.md`
- **PROJECT_BIBLE:** `Docs/PROJECT_BIBLE.md` (¬ß12 ‚Äî Changelog v2.1)
- **–ö–æ–¥:**
  - `Services/TransactionCacheManager.swift`
  - `Services/BalanceCalculationService.swift`
  - `ViewModels/TransactionsViewModel.swift`
  - `Views/ContentView.swift`
  - `Views/History/HistoryTransactionsList.swift`
