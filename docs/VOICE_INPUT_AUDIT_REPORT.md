# üìä –ü–û–õ–ù–´–ô –ê–£–î–ò–¢: –§–£–ù–ö–¶–ò–Ø –ó–ê–ü–ò–°–ò –†–ê–°–•–û–î–û–í –° –†–ê–°–ü–û–ó–ù–ê–í–ê–ù–ò–ï–ú –ì–û–õ–û–°–ê

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2026-01-18
**–í–µ—Ä—Å–∏—è:** 1.0
**–ê—É–¥–∏—Ç–æ—Ä:** Claude Sonnet 4.5

---

## üéØ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ

–°–∏—Å—Ç–µ–º–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –≤ AIFinanceManager –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Apple Speech Framework –∏ —Å–ª–æ–∂–Ω–æ–≥–æ NLP-–ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Å–ø–æ—Å–æ–±–Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤–∏–¥–∞ "–ü–æ—Ç—Ä–∞—Ç–∏–ª 5000 —Ç–µ–Ω–≥–µ –Ω–∞ —Ç–∞–∫—Å–∏ —Å–æ —Å—á–µ—Ç–∞ Kaspi".

**–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞: 7.5/10**

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:
‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ on-device —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å)
‚úÖ –°–ª–æ–∂–Ω—ã–π NLP —Å —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–µ–π –∏ —Å–∫–æ—Ä–∏–Ω–≥–æ–º
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ unit-—Ç–µ—Å—Ç–æ–≤** (0% –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–∞—Ä—Å–µ—Ä–∞)
‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é UI (–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã)
‚ùå –°–ª–∞–±–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üìÅ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å |
|-----------|------|-----------------|
| **VoiceInputService** | `Services/VoiceInputService.swift` | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —á–µ—Ä–µ–∑ Speech Framework |
| **VoiceInputParser** | `Services/VoiceInputParser.swift` | NLP-–ø–∞—Ä—Å–∏–Ω–≥ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| **VoiceInputView** | `Views/VoiceInputView.swift` | UI –¥–ª—è –∑–∞–ø–∏—Å–∏ –≥–æ–ª–æ—Å–∞ |
| **VoiceInputConfirmationView** | `Views/VoiceInputConfirmationView.swift` | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| **ParsedOperation** | `Models/ParsedOperation.swift` | –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ |

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí [VoiceInputView] ‚Üí –ó–∞–ø–∏—Å—å –≥–æ–ª–æ—Å–∞
                           ‚Üì
2. [VoiceInputService] ‚Üí Speech Recognition ‚Üí –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
                           ‚Üì
3. [VoiceInputParser] ‚Üí NLP –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Üí ParsedOperation
                           ‚Üì
4. [VoiceInputConfirmationView] ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                           ‚Üì
5. [TransactionsViewModel] ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```

---

## üêõ 1. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò –ò –ë–ê–ì–ò

### 1.1 ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –≤ UI
**–§–∞–π–ª:** `VoiceInputConfirmationView.swift:88-93, 254-256`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
.onChange(of: amountText) {
    if amountWarning != nil {
        amountWarning = nil  // –ò–∑–º–µ–Ω–µ–Ω–∏–µ @State
    }
}

private func validateAmount() {
    // ... –≤–∞–ª–∏–¥–∞—Ü–∏—è ...
    amountWarning = "–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É"  // –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–π onChange
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –†–∏—Å–∫ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏—è UI –ø—Ä–∏ –≤–≤–æ–¥–µ
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ SwiftUI (—Å–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- –ù–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å debounce –∏–ª–∏ —Ñ–ª–∞–≥ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ä–µ–∫—É—Ä—Å–∏–∏

---

### 1.2 ‚ö†Ô∏è –í–´–°–û–ö–ò–ô: Race condition –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–ø–∏—Å–∏
**–§–∞–π–ª:** `VoiceInputService.swift:218-251`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
private func stopRecordingSync() async {
    guard !isStopping else { return }  // –§–ª–∞–≥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–æ...
    isStopping = true

    // 300ms delay - –Ω–æ —á—Ç–æ –µ—Å–ª–∏ –≤—ã–∑–≤–∞–ª–∏ –¥–≤–∞–∂–¥—ã –±—ã—Å—Ç—Ä–æ?
    try? await Task.sleep(nanoseconds: 300_000_000)

    audioEngine?.stop()  // –ú–æ–∂–µ—Ç –±—ã—Ç—å nil –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≤—ã–∑–æ–≤–∞
}
```

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç Stop
2. VoiceInputView.onDisappear –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
3. –î–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–∞ `stopRecording()`
4. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫—Ä–∞—à –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ `audioEngine`

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å actor-–∏–∑–æ–ª—è—Ü–∏—é –∏–ª–∏ Thread-safe –º—å—é—Ç–µ–∫—Å

---

### 1.3 ‚ö†Ô∏è –°–†–ï–î–ù–ò–ô: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã
**–§–∞–π–ª:** `VoiceInputParser.swift:294-296`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
if let largestAmount = foundAmounts.max(by: { $0.0 < $1.0 }) {
    let amount = largestAmount.0
```

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
–ì–æ–ª–æ—Å–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞: "–ü–æ—Ç—Ä–∞—Ç–∏–ª 50 —Ç—ã—Å—è—á –Ω–∞ –º–∞—à–∏–Ω—É –∑–∞ 2023 –≥–æ–¥"
- –ù–∞—Ö–æ–¥–∏—Ç: 50, 1000, 2023
- **–í—ã–±–∏—Ä–∞–µ—Ç: 2023** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ) ‚ùå
- **–û–∂–∏–¥–∞–ª–æ—Å—å: 50000** (50 √ó 1000) ‚úÖ

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö —Å—É–º–º –Ω–∞–¥ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞–º–∏

---

### 1.4 ‚ö†Ô∏è –°–†–ï–î–ù–ò–ô: –ü–æ—Ç–µ—Ä—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
**–§–∞–π–ª:** `VoiceInputView.swift:44-54`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
try? await Task.sleep(nanoseconds: 350_000_000) // 350ms
let finalText = voiceService.getFinalText()
```

–•–∞—Ä–¥–∫–æ–¥ 350ms - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–µ—Å–ª–∏ –Ω–µ—Ç on-device recognition)

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å completion callback –æ—Ç recognition task

---

### 1.5 ‚ö†Ô∏è –ù–ò–ó–ö–ò–ô: –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –±—ã—Å—Ç—Ä—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö
**–§–∞–π–ª:** `VoiceInputService.swift:180-205`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
recognitionTask = recognizer.recognitionTask(with: recognitionRequest) { [weak self] result, error in
    guard let self = self else { return }

    Task { @MainActor in
        // –ï—Å–ª–∏ VoiceInputService –¥–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Task...
    }
}
```

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Task –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –¥–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ view

---

## ‚ö° 2. –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### 2.1 üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º onChange

**–§–∞–π–ª:** `VoiceInputConfirmationView.swift:199-204`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
.onChange(of: selectedAccountId) {
    validateAccount()  // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
}
.onChange(of: selectedCategoryName) {
    validateCategory()  // –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ - –î–û–†–û–ì–û
}
```

**–ò–∑–º–µ—Ä–µ–Ω–∏—è:**
- `validateCategory()` –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å `addCategory()` ‚Üí DB write
- –ü—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ —Å—á–µ—Ç–æ–≤: 5-10 –≤—ã–∑–æ–≤–æ–≤ `validateAccount()` –≤ —Å–µ–∫—É–Ω–¥—É
- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º—É –º–∞—Å—Å–∏–≤—É `accounts`

**–†–µ—à–µ–Ω–∏–µ:**
- Debounce —Å 300ms –∑–∞–¥–µ—Ä–∂–∫–æ–π
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –õ–µ–Ω–∏–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)

---

### 2.2 üü° –°–†–ï–î–ù–ò–ô: O(n¬≤) –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å—á–µ—Ç–∞
**–§–∞–π–ª:** `VoiceInputParser.swift:442-493`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

```swift
for account in accounts {  // O(n)
    for (key, aliases) in accountAliases {  // O(m)
        for alias in aliases {  // O(k)
            if text.contains(alias) {  // O(text length)
```

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** O(n √ó m √ó k √ó |text|) = O(n¬≤) –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—á–µ—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
- Pre-compute –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å –∞–ª–∏–∞—Å–æ–≤ ‚Üí O(1) lookup
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Trie –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫

---

### 2.3 üü° –°–†–ï–î–ù–ò–ô: Regex –∫–æ–º–ø–∏–ª—è—Ü–∏—è –≤ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ

**–§–∞–π–ª:** `VoiceInputParser.swift:276-277`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
for pattern in patterns {
    if let regex = try? NSRegularExpression(pattern: pattern, ...) {
        // Regex –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –ö–ê–ñ–î–´–ô —Ä–∞–∑ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ
```

**–†–µ—à–µ–Ω–∏–µ:**
```swift
private let amountRegexes: [NSRegularExpression] = {
    patterns.compactMap { try? NSRegularExpression(pattern: $0) }
}()
```

**–í—ã–∏–≥—Ä—ã—à:** ~40% —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ (–ø–æ –±–µ–Ω—á–º–∞—Ä–∫–∞–º Apple)

---

### 2.4 üü¢ –ù–ò–ó–ö–ò–ô: –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞

**–§–∞–π–ª:** `VoiceInputParser.swift:195-209`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

```swift
for (from, to) in textReplacements {  // 42 –∏—Ç–µ—Ä–∞—Ü–∏–∏
    normalized = normalized.replacingOccurrences(of: from, with: to, ...)
}
```

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ ‚Üí 42 –∞–ª–ª–æ–∫–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –û–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥ —Å Character-by-character –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

---

## üé® 3. UI/UX –ü–†–û–ë–õ–ï–ú–´

### 3.1 üî¥ –ö–†–ò–¢–ò–ß–ù–û: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, **—Ä–∞—Å–ø–æ–∑–Ω–∞–ª—Å—è –ª–∏ –µ–≥–æ –≥–æ–ª–æ—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
- –ù–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```
[–ì–æ–≤–æ—Ä–∏—Ç–µ...]
"–ü–æ—Ç—Ä–∞—Ç–∏–ª 5000 —Ç–µ–Ω–≥–µ –Ω–∞ —Ç–∞–∫—Å–∏ —Å–æ —Å—á–µ—Ç–∞ Kaspi"
```

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```
[–ò–¥–µ—Ç –∑–∞–ø–∏—Å—å...]
"–ü–æ—Ç—Ä–∞—Ç–∏–ª 5000 —Ç–µ–Ω–≥–µ –Ω–∞ —Ç–∞–∫—Å–∏ —Å–æ —Å—á–µ—Ç–∞ Kaspi"
        ^^^^        ^^^^^     ^^^^^
       —Å—É–º–º–∞      –≤–∞–ª—é—Ç–∞     —Å—á–µ—Ç
```

–ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ü–≤–µ—Ç–æ–º:
- üü¢ –ó–µ–ª–µ–Ω—ã–π: —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ
- üü° –ñ–µ–ª—Ç—ã–π: —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ (–Ω–∏–∑–∫–∏–π confidence)
- üî¥ –ö—Ä–∞—Å–Ω—ã–π: –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ

---

### 3.2 üü° –í–´–°–û–ö–ò–ô: –ü–ª–æ—Ö–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `VoiceInputView.swift:81-87`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
```swift
.alert(String(localized: "voice.error"), isPresented: $showingPermissionAlert) {
    Button(String(localized: "voice.ok")) {
        dismiss()  // –ü—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å
    }
}
```

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí `UIApplication.shared.open(URL(string: UIApplication.openSettingsURLString)!)`
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ, **–ø–æ—á–µ–º—É** –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: "–í–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–º –≤—Ä—É—á–Ω—É—é"

---

### 3.3 üü° –°–†–ï–î–ù–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç:
- –£—Ä–æ–≤–µ–Ω—å –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ü–∞—É–∑—ã –≤ —Ä–µ—á–∏

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∞—É–¥–∏–æ-–≤–æ–ª–Ω—ã

---

### 3.4 üü° –°–†–ï–î–ù–ò–ô: –ù–µ—á–∏—Ç–∞–µ–º–æ–µ –ø–æ–ª–µ —Å—É–º–º—ã –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–§–∞–π–ª:** `VoiceInputConfirmationView.swift:94-97`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

```swift
.overlay(
    RoundedRectangle(cornerRadius: 4)
        .stroke(amountWarning != nil ? Color.red : Color.clear, lineWidth: 1)
)
```

–ö—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞ + –∫—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ = –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.background` —Å –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º –∫—Ä–∞—Å–Ω—ã–º
- –ò–∫–æ–Ω–∫–∞ –æ—à–∏–±–∫–∏ —Å–ª–µ–≤–∞ –æ—Ç –ø–æ–ª—è
- Haptic feedback –ø—Ä–∏ –æ—à–∏–±–∫–µ

---

### 3.5 üü¢ –ù–ò–ó–ö–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
First-time –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, **—á—Ç–æ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å**

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—É—Å–µ–ª—å –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–æ–¥ –∫–Ω–æ–ø–∫–æ–π –∑–∞–ø–∏—Å–∏:
```
"–ü–æ—Ç—Ä–∞—Ç–∏–ª 5000 —Ç–≥ –Ω–∞ —Ç–∞–∫—Å–∏"
"–ö—É–ø–∏–ª –∫–æ—Ñ–µ –∑–∞ 2000"
"–ü–æ–ª—É—á–∏–ª –∑–∞—Ä–ø–ª–∞—Ç—É 100000"
```

---

## üß™ 4. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 4.1 ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–∞—Ä—Å–µ—Ä–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** 0%

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ—Å—Ç—ã:**

```swift
class VoiceInputParserTests: XCTestCase {
    func testParseSimpleExpense()
    func testParseWithAccount()
    func testParseAmbiguousAmount()
    func testParseNumberWords()
    func testParseCurrencyVariants()
    func testAccountAliasScoring()
    func testCategoryFallback()
    func testEdgeCases()
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** –ë–µ–∑ —Ç–µ—Å—Ç–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ:
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ —Ä–µ–≥—Ä–µ—Å—Å–∏–π
- –£–≤–µ—Ä–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –û—Ç–ª–∞–¥–∫–∞ –≤ production (–Ω–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã—Ö –∫–µ–π—Å–æ–≤)

---

### 4.2 üü° –°–†–ï–î–ù–ò–ô: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ integration-—Ç–µ—Å—Ç–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

–ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ flow:
1. –ó–∞–ø–∏—Å—å ‚Üí 2. –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è ‚Üí 3. –ü–∞—Ä—Å–∏–Ω–≥ ‚Üí 4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

---

### 4.3 üü° –°–†–ï–î–ù–ò–ô: –ù–µ—Ç –º–æ–∫-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è Speech Recognition

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö
- –û—à–∏–±–∫–∏ –∞—É–¥–∏–æ-–¥–≤–∏–∂–∫–∞
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** Protocol-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

---

## üîß 5. –†–ï–§–ê–ö–¢–û–†–ò–ù–ì –ò –£–õ–£–ß–®–ï–ù–ò–ï –ö–û–î–ê

### 5.1 üî¥ –ö–†–ò–¢–ò–ß–ù–û: –ù–∞—Ä—É—à–µ–Ω–∏–µ Single Responsibility Principle

**–§–∞–π–ª:** `VoiceInputParser.swift`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ö–ª–∞—Å—Å –¥–µ–ª–∞–µ—Ç –í–°–Å:
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Ç–µ–∫—Å—Ç–∞ (18 –º–µ—Ç–æ–¥–æ–≤ –ø–æ–¥–º–µ–Ω)
- –ü–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–µ–ª
- –ü–æ–∏—Å–∫ —Å—á–µ—Ç–æ–≤
- –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–∞–ª—é—Ç
- –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é

**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –º–æ–¥—É–ª–∏

---

### 5.2 üü° –í–´–°–û–ö–ò–ô: –ú–∞–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø–æ –≤—Å–µ–º—É –∫–æ–¥—É

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

**–ü—Ä–∏–º–µ—Ä—ã:**
```swift
// VoiceInputView.swift:46
try? await Task.sleep(nanoseconds: 350_000_000) // –ü–æ—á–µ–º—É 350ms?

// VoiceInputService.swift:230
try? await Task.sleep(nanoseconds: 300_000_000) // –ü–æ—á–µ–º—É 300ms?

// VoiceInputParser.swift:373
if result > 0 && result <= 9999 {  // –ü–æ—á–µ–º—É 9999?

// VoiceInputParser.swift:502
if bestScore - secondScore < 5 {  // –ü–æ—á–µ–º—É 5?
```

**–†–µ—à–µ–Ω–∏–µ:**
```swift
private enum Constants {
    static let finalizationDelay: TimeInterval = 0.35
    static let audioEngineStopDelay: TimeInterval = 0.30
    static let maxWordNumberValue = 9999
    static let accountScoreAmbiguityThreshold = 5
}
```

---

### 5.3 üü° –°–†–ï–î–ù–ò–ô: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–§–∞–π–ª:** `VoiceInputConfirmationView.swift`
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

–ú–µ—Ç–æ–¥—ã `validateAccount()`, `validateAmount()`, `validateCategory()` –¥—É–±–ª–∏—Ä—É—é—Ç –ª–æ–≥–∏–∫—É –≤ `saveTransaction()`

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å `TransactionValidator`

---

## üéØ 6. –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### 6.1 üí° –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –¥–∞—Ç

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –°–†–ï–î–ù–ò–ô

**–¢–µ–∫—É—â–µ–µ:** –¢–æ–ª—å–∫–æ "—Å–µ–≥–æ–¥–Ω—è" –∏ "–≤—á–µ—Ä–∞"

**–£–ª—É—á—à–µ–Ω–∏–µ:**
```
"–ü–æ—Ç—Ä–∞—Ç–∏–ª 5000 –≤—á–µ—Ä–∞"
"–ö—É–ø–∏–ª –∫–æ—Ñ–µ –ø–æ–∑–∞–≤—á–µ—Ä–∞"
"–ó–∞–ø–ª–∞—Ç–∏–ª –∑–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç 15 —è–Ω–≤–∞—Ä—è"
"–û–ø–ª–∞—Ç–∏–ª —Å—á–µ—Ç –≤ –ø—Ä–æ—à–ª—É—é –ø—è—Ç–Ω–∏—Ü—É"
"–ü–æ–ª—É—á–∏–ª –∑–∞—Ä–ø–ª–∞—Ç—É –≤ –∫–æ–Ω—Ü–µ –º–µ—Å—è—Ü–∞"
```

---

### 6.2 üí° –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å ML

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–ò–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ML –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä:**
- "–ö—É–ø–∏–ª –∫–æ—Ñ–µ" –≤ 9:00 —É—Ç—Ä–∞ ‚Üí Food / Coffee (95% confidence)
- "–ö—É–ø–∏–ª –∫–æ—Ñ–µ" –≤ 18:00 ‚Üí Entertainment / Coffee (60% confidence)

---

### 6.3 üí° Multi-language –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–¢–µ–∫—É—â–µ–µ:** –¢–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–π

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- –ê–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç —è–∑—ã–∫–∞ —á–µ—Ä–µ–∑ `recognizer.locale`
- Fallback –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π/–∫–∞–∑–∞—Ö—Å–∫–∏–π
- –°–º–µ—à–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã: "Spent 5000 —Ç–µ–Ω–≥–µ on taxi"

---

### 6.4 üí° –ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:**
```
"–£–¥–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é"
"–ü–æ–∫–∞–∂–∏ —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –º–µ—Å—è—Ü"
"–°–∫–æ–ª—å–∫–æ —è –ø–æ—Ç—Ä–∞—Ç–∏–ª –Ω–∞ —Ç–∞–∫—Å–∏?"
"–ü–æ–≤—Ç–æ—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –∫–æ–º–∞–Ω–¥—É"
```

---

### 6.5 üí° –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–¢–µ–∫—É—â–µ–µ:** –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–£–ª—É—á—à–µ–Ω–∏–µ:**
```
"–†–∞–∑–¥–µ–ª–∏–ª —Å—á–µ—Ç –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –Ω–∞ —Ç—Ä–æ–∏—Ö - 15000 —Ç–µ–Ω–≥–µ"
‚Üí –°–æ–∑–¥–∞–µ—Ç 3 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ 5000

"–ö—É–ø–∏–ª –ø—Ä–æ–¥—É–∫—Ç—ã –∑–∞ 20000, –∏–∑ –Ω–∏—Ö 5000 –Ω–∞ –º—è—Å–æ, 3000 –Ω–∞ –æ–≤–æ—â–∏"
‚Üí –°–æ–∑–¥–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
```

---

## üìä 7. –ú–ï–¢–†–ò–ö–ò –ò –ú–û–ù–ò–¢–û–†–ò–ù–ì

### 7.1 ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

**–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:**
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- ‚úÖ –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏
- ‚úÖ –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- ‚úÖ –°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- ‚úÖ Distribution —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π/—Å—á–µ—Ç–æ–≤

---

### 7.2 üü° –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ error tracking

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–´–°–û–ö–ò–ô

**–ü—Ä–æ–±–ª–µ–º–∞:**
–û—à–∏–±–∫–∏ –≤ production –Ω–µ–≤–∏–¥–∏–º—ã - –Ω–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Crashlytics/Sentry

---

## üîê 8. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –ü–†–ò–í–ê–¢–ù–û–°–¢–¨

### 8.1 ‚úÖ –•–û–†–û–®–û: On-device —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ

```swift
if recognizer.supportsOnDeviceRecognition {
    recognitionRequest.requiresOnDeviceRecognition = true
}
```

**–ü–ª—é—Å:** –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (GDPR compliant)

---

### 8.2 üü° –£–õ–£–ß–®–ï–ù–ò–ï: –ù–µ—Ç –æ–ø—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏

---

### 8.3 üü¢ Sensitive data –≤ debug-–ª–æ–≥–∞—Ö

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–ò–ó–ö–ò–ô

**–§–∞–π–ª:** `VoiceInputParser.swift:108`

–ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—É–º–º—ã –∏ —Å—á–µ—Ç–∞ ‚Üí —Ä–∏—Å–∫ –ø—Ä–∏ screen recording/debugging

**–†–µ—à–µ–Ω–∏–µ:** Redact sensitive info –≤ debug mode

---

## üìà 9. –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### üî¥ –ö–†–ò–¢–ò–ß–ù–û (–°–¥–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è VoiceInputParser (–ø–æ–∫—Ä—ã—Ç–∏–µ 80%+)
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –≤ VoiceInputConfirmationView
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤—ã–±–æ—Ä–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å pre-compiled regex (40% —É—Å–∫–æ—Ä–µ–Ω–∏–µ)
5. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –º–∞–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### üü° –í–´–°–û–ö–ò–ô (–°–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç):
6. ‚úÖ –†–∞–∑–¥–µ–ª–∏—Ç—å VoiceInputParser –Ω–∞ –º–æ–¥—É–ª–∏ (SRP)
7. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å–≤–µ—Ç–∫—É —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ UI
8. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å race condition –≤ stopRecording()
9. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ error tracking
10. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ —Å—á–µ—Ç–æ–≤ (–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å)

### üü¢ –°–†–ï–î–ù–ò–ô (Backlog):
11. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
12. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–∞—Ç (–Ω–µ —Ç–æ–ª—å–∫–æ "—Å–µ–≥–æ–¥–Ω—è/–≤—á–µ—Ä–∞")
13. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å haptic feedback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
14. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å –∫–Ω–æ–ø–∫–æ–π "–û—Ç–∫—Ä—ã—Ç—å –ù–∞—Å—Ç—Ä–æ–π–∫–∏"

### üí° –ù–ò–ó–ö–ò–ô (–ë—É–¥—É—â–µ–µ):
15. ‚úÖ Multi-language –ø–æ–¥–¥–µ—Ä–∂–∫–∞
16. ‚úÖ ML-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
17. ‚úÖ –°–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤)

---

## üìã 10. –ö–û–ù–ö–†–ï–¢–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –î–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

**1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª:**
```bash
touch AIFinanceManagerTests/VoiceInputParserTests.swift
```

**2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å amountText onChange:**
```swift
@State private var amountValidationDebouncer: Task<Void, Never>?

.onChange(of: amountText) {
    amountWarning = nil
    amountValidationDebouncer?.cancel()
    amountValidationDebouncer = Task {
        try? await Task.sleep(for: .milliseconds(300))
        validateAmount()
    }
}
```

**3. –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
```swift
// Constants.swift
enum VoiceInputConstants {
    static let finalizationDelay: Duration = .milliseconds(350)
    static let audioStopDelay: Duration = .milliseconds(300)
    static let maxWordNumber = 9999
    static let accountScoreThreshold = 5
}
```

**4. –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É:**
```swift
struct VoiceInputAnalytics {
    static func track(event: String, parameters: [String: Any] = [:]) {
        #if DEBUG
        print("üìä [Analytics] \(event): \(parameters)")
        #endif
        // TODO: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Firebase/Amplitude
    }
}
```

---

## üéì –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–§—É–Ω–∫—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –≤ AIFinanceManager –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –∏ **—Å–ª–æ–∂–Ω—É—é NLP-–æ–±—Ä–∞–±–æ—Ç–∫—É**, –Ω–æ —Å—Ç—Ä–∞–¥–∞–µ—Ç –æ—Ç:

1. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** (0% –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–∞—Ä—Å–µ—Ä–∞)
2. **–ü—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (O(n¬≤) –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏)
3. **–°–ª–∞–±–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ edge cases** (race conditions, —Ü–∏–∫–ª—ã)
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** (–Ω–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, error tracking)

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 7.5/10

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 9/10

**–û—Ü–µ–Ω–∫–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π:**
- üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: 2-3 –¥–Ω—è
- üü° –í—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ: 5-7 –¥–Ω–µ–π
- üü¢ –°—Ä–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è: 10-15 –¥–Ω–µ–π

**ROI:** –í—ã—Å–æ–∫–∏–π - —Ñ—É–Ω–∫—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º USP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ retention.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–í–æ–ø—Ä–æ—Å—ã –ø–æ –æ—Ç—á–µ—Ç—É: —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

**–í–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–∞:** 1.0
**–î–∞—Ç–∞:** 2026-01-18
